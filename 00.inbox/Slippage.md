
# 슬리피지(Slippage) 완벽 가이드

## 1. 슬리피지 기본 개념

**슬리피지(Slippage)**는 거래를 주문할 때 예상했던 가격과 실제로 체결된 가격 사이의 차이를 의미합니다. 주로 백분율(%)로 표현됩니다.

### 1.1 간단한 예시
```
예상 가격: 1 ETH = 2,000 USDC
실제 체결: 1 ETH = 1,980 USDC
슬리피지: (2,000 - 1,980) / 2,000 = 1%
```

## 2. 슬리피지가 발생하는 이유

### 2.1 AMM의 가격 메커니즘
```
Uniswap의 x * y = k 공식:

초기 상태: 
- ETH: 100개
- USDC: 200,000개
- 가격: 1 ETH = 2,000 USDC

10 ETH 구매 후:
- ETH: 90개 (-10)
- USDC: 222,222개 (+22,222)
- 새 가격: 1 ETH = 2,469 USDC

→ 거래 규모가 클수록 가격 영향 증가
```

### 2.2 시간 지연
1. **주문 제출** → 메모리풀 대기
2. **다른 거래들 먼저 실행** → 가격 변동
3. **내 거래 실행** → 변경된 가격에 체결

### 2.3 MEV 봇의 개입
```
시나리오:
1. 사용자: 1 ETH를 2,000 USDC에 구매 주문
2. MEV 봇: 먼저 ETH 대량 구매 (프론트러닝)
3. 가격 상승: 1 ETH = 2,050 USDC
4. 사용자 거래: 더 비싼 가격에 체결
```

## 3. 슬리피지의 유형

### 3.1 가격 영향(Price Impact)
- **정의**: 내 거래가 시장 가격에 미치는 영향
- **계산 가능**: 거래 전에 예측 가능
- **예시**: 유동성 풀 대비 큰 거래

### 3.2 실행 슬리피지(Execution Slippage)
- **정의**: 주문과 체결 사이의 시장 변동
- **예측 어려움**: 다른 거래자들의 활동에 의존
- **예시**: 변동성 높은 시장에서 발생

## 4. 슬리피지 허용치(Slippage Tolerance)

### 4.1 설정의 의미
```javascript
// Uniswap에서 슬리피지 1% 설정
{
  expectedOutput: 2000 USDC,
  minimumOutput: 1980 USDC,  // 1% 슬리피지 허용
  slippageTolerance: 1%
}
```

### 4.2 적절한 슬리피지 설정
```
안정적인 토큰 (USDC/USDT):
- 권장: 0.1% - 0.3%
- 이유: 가격 변동성 낮음

주요 토큰 (ETH/BTC):
- 권장: 0.5% - 1%
- 이유: 적당한 유동성과 변동성

변동성 높은 토큰 (밈코인):
- 권장: 3% - 5% 이상
- 이유: 급격한 가격 변동

거래 규모별:
- 소액: 0.5% - 1%
- 중간: 1% - 2%
- 대규모: 2% - 5%
```

## 5. 슬리피지 계산 예시

### 5.1 실제 계산
```
거래: 10,000 USDC로 ETH 구매
예상 가격: 1 ETH = 2,000 USDC
예상 수량: 5 ETH

시나리오 1 (0.5% 슬리피지):
- 최소 수령: 4.975 ETH
- 최대 가격: 2,010 USDC/ETH

시나리오 2 (2% 슬리피지):
- 최소 수령: 4.9 ETH
- 최대 가격: 2,040 USDC/ETH
```

### 5.2 유동성 풀 크기의 영향
```
작은 풀 (TVL: $100,000):
- $1,000 거래 → ~2% 가격 영향
- $10,000 거래 → ~20% 가격 영향

큰 풀 (TVL: $10,000,000):
- $1,000 거래 → ~0.02% 가격 영향
- $10,000 거래 → ~0.2% 가격 영향
```

## 6. 슬리피지 관련 위험

### 6.1 너무 낮은 슬리피지
```
설정: 0.1%
문제:
- 거래 실패 가능성 높음
- 가스비만 소모
- 여러 번 재시도 필요
```

### 6.2 너무 높은 슬리피지
```
설정: 10%
위험:
- MEV 봇의 표적
- 샌드위치 공격 취약
- 예상보다 훨씬 나쁜 가격에 체결
```

## 7. 슬리피지 최소화 전략

### 7.1 거래 분할
```javascript
// 한 번에 100 ETH 대신
const orders = [
  { amount: 20 ETH, delay: 5분 },
  { amount: 20 ETH, delay: 5분 },
  { amount: 20 ETH, delay: 5분 },
  { amount: 20 ETH, delay: 5분 },
  { amount: 20 ETH, delay: 5분 }
]
```

### 7.2 최적 경로 찾기
- **1inch**: 여러 DEX 경로 최적화
- **Matcha**: 최저 슬리피지 경로 제공
- **Paraswap**: 멀티 경로 분할

### 7.3 시간대 선택
```
최적 시간:
- 미국 새벽 (낮은 활동)
- 주말 (적은 거래량)

피해야 할 시간:
- 중요 뉴스 발표 시
- 미국 장 시작/마감
- 높은 변동성 기간
```

## 8. DEX별 슬리피지 처리

### 8.1 Uniswap
- 자동 슬리피지 추천
- V3: 집중 유동성으로 슬리피지 감소
- 고급 설정 가능

### 8.2 SushiSwap
- 기본 0.5% 설정
- 라우팅 최적화 기능

### 8.3 Curve
- 스테이블코인 특화
- 매우 낮은 슬리피지 (0.04%)
- 대규모 거래에도 안정적

## 9. 실전 팁

### 9.1 슬리피지 체크리스트
1. **거래 전 확인**
   - 현재 가격 확인
   - 유동성 풀 크기 확인
   - 최근 거래 내역 확인

2. **적절한 설정**
   - 토큰 특성에 맞게 조정
   - 시장 상황 고려
   - MEV 방어 고려

3. **모니터링**
   - 거래 결과 확인
   - 실제 슬리피지 기록
   - 패턴 분석

### 9.2 문제 해결
```
거래 계속 실패?
→ 슬리피지 0.5%씩 증가

MEV 봇에 계속 당함?
→ Private mempool 사용
→ 슬리피지 낮추고 여러 번 시도

가격 영향이 너무 큼?
→ 다른 DEX 확인
→ 거래 분할
→ 리밋 오더 사용
```

## 결론

슬리피지는 DEX 거래의 필수적인 부분이며, 적절한 이해와 관리를 통해 거래 비용을 최소화하고 MEV 공격을 방어할 수 있습니다. 각 상황에 맞는 최적의 슬리피지 설정을 찾는 것이 성공적인 DeFi 거래의 핵심입니다.